<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Controle de Estoque - Bobinas de Papel</title>

  <link rel="stylesheet" href="style.css" />
  <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.5/dist/JsBarcode.all.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.1/build/qrcode.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

  <style></style>
</head>

<body>
  <header>
    <div class="container">
      <h1>Controle de Estoque - Bobinas de Papel</h1>
    </div>
  </header>
  <!-- Cabe√ßalho com logo -->
  <header class="header-empresa">
    <img src="WhatsApp Image 2025-10-16 at 10.34.12.jpeg" alt="We Papel" class="logo-empresa" />
  </header>




  <div class="container">
    <div class="tabs no-print">
      <div class="tab active" onclick="openTab('cadastro', event)">Cadastro</div>
      <div class="tab" onclick="openTab('estoque', event)">Estoque</div>
      <div class="tab" onclick="openTab('movimentacao', event)">Movimenta√ß√£o</div>
      <div class="tab" onclick="openTab('relatorios', event)">Relat√≥rios</div>
    </div>


    <div id="cadastro" class="tab-content active">
      <div class="table-responsive">
        <div class="card">
          <h2>Cadastrar Nova Bobina</h2>
          <div class="btn-importar-excel">
            <input type="file" id="inputExcel" accept=".xlsx, .xls" hidden />

            <button class="btn" onclick="document.getElementById('inputExcel').click()">
              üì• Importar Excel
            </button>
          </div>
          <form id="formBobina">
            <div class="form-group">
              <label for="tipoPapel">Tipo de Papel:</label>
              <select id="tipoPapel" required>
                <option value="">Selecione...</option>
                <option value="Papel barreira gordura">
                  Papel barreira gordura
                </option>
                <option value="Kraft Natural">Kraft Natural</option>
                <option value="Kraft Monol√∫cido">Kraft Monol√∫cido</option>
                <option value="Kraft Branco">Kraft Branco</option>
                <option value="BOPP Metalizado">BOPP Metalizado</option>
                <option value="BOPP Branco">BOPP Branco</option>
                <option value="Glassine">Glassine</option>
                <option value="Seda">Seda</option>
                <option value="Monol√∫cido">Monol√∫cido</option>
                <option value="Glasspel">Glasspel</option>
                <option value="OffSet">OffSet</option>
                <option value="Filme Pl√°stico">Filme Pl√°stico</option>
              </select>

            </div>


            <div class="form-group">
              <label for="fabricante">Fabricante:</label>
              <input type="text" id="fabricante" required />
            </div>

            <div class="form-group">
              <label for="peso">Peso (kg):</label>
              <input type="number" id="peso" step="0.01" min="0" required />
            </div>

            <div class="form-group">
              <label for="largura">Largura (cm):</label>
              <input type="number" id="largura" step="0.01" min="0" required />
            </div>

            <div class="form-group">
              <label for="gramatura">Gramatura (g/m¬≤):</label>
              <input type="number" id="gramatura" step="0.01" min="0" required />
            </div>

            <div class="form-group">
              <label for="fornecedor">Fornecedor:</label>
              <input type="text" id="fornecedor" required />
            </div>

            <div class="form-group">
              <label for="localizacao">Localiza√ß√£o:</label>
              <input type="text" id="localizacao" value="Armaz√©m Principal" required />
            </div>

            <button type="submit">Cadastrar Bobina</button>
            <button type="button" id="cancelarEdicao" class="btn-danger" style="display: none; margin-left: 10px">
              Cancelar Edi√ß√£o
            </button>
          </form>
        </div>
      </div>
    </div>
    <!-- üîπ In√≠cio da aba Estoque -->
    <div id="estoque" class="tab-content">
      <div class="card">
        <div style="display: flex; justify-content: space-between; align-items: center;">
          <h2 id="tituloEstoque">Estoque Atual</h2>
          <button id="btnAlternarEstoque" class="no-print" style="padding: 8px 14px" onclick="alternarTabelas()">
            Ver Bobinas Eliminadas
          </button>
        </div>

        <div class="form-group no-print" id="filtroEstoqueContainer">
          <label for="filtro">Filtrar:</label>
          <input type="text" id="filtro" placeholder="Digite para filtrar..." />
        </div>

        <!-- Tabela de Estoque Normal -->
        <div class="table-responsive" id="tabelaEstoqueContainer">
          <table id="tabelaEstoque">
            <thead>
              <tr>
                <th>ID</th>
                <th>Tipo</th>
                <th>Localiza√ß√£o</th>
                <th>Peso (kg)</th>
                <th>Largura</th>
                <th>Gramatura</th>
                <th>Status</th>
                <th class="no-print">A√ß√µes</th>
              </tr>
            </thead>
            <tbody id="corpoTabelaEstoque"></tbody>
            <div class="no-print" style="display: flex; gap: 10px; margin-top: 10px;">
  <button
    class="btn"
    onclick="exportarEstoqueCompletoExcel()"
  >
    üì§ Exportar Estoque (Excel)
  </button>

  <button
    class="btn"
    onclick="toggleBobinasEmUso()"
  >
    ‚öôÔ∏è Ver Bobinas em Uso
  </button>
</div>


          </table>
        </div>

        <!-- Tabela de Bobinas Eliminadas -->
        <div class="table-responsive" id="tabelaEliminadasContainer" style="display: none;">
          <table id="tabelaEliminadas">
            <thead>
              <tr>
                <th>ID</th>
                <th>Tipo</th>
                <th>Fabricante</th>
                <th>Peso (kg)</th>
                <th>Largura</th>
                <th>Gramatura</th>
                <th>Data de Sa√≠da</th>
                <th class="no-print">A√ß√µes</th>
              </tr>
            </thead>
            <tbody id="corpoTabelaEliminadas">
              <tr>
                <td colspan="8">Nenhuma bobina eliminada</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <button class="btn btn-danger no-print" style="margin-left: 10px" onclick="apagarTodoEstoque() ">
        üóëÔ∏è Apagar todo o estoque
      </button>
    </div>
    <!-- üîπ Fim da aba Estoque -->



    <div id="movimentacao" class="tab-content">
      <div class="card">
        <h2>Hist√≥rico de Movimenta√ß√£o</h2>
        <div class="table-responsive">
          <table id="tabelaHistorico">
            <thead>
              <tr>
                <th>Data/Hora</th>
                <th>Bobina</th>
                <th>Tipo</th>
                <th>Peso (kg)</th>
                <th>Usu√°rio</th>
                <th>Perda (kg)</th>
                <th>Observa√ß√µes</th>
                <th class="no-print">A√ß√µes</th> <!-- üëà ADICIONE ESTA LINHA -->
              </tr>
            </thead>
            <tbody id="corpoTabelaHistorico">
              <!-- Dados ser√£o inseridos via JavaScript -->
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <div id="relatorios" class="tab-content">
      <div class="card">
        <h2>Relat√≥rios</h2>
        <div class="form-group">
          <label for="tipoRelatorio">Tipo de Relat√≥rio:</label>
          <select id="tipoRelatorio">
            <option value="estoqueAtual">Estoque Atual</option>
            <option value="movimentacaoPeriodo">
              Movimenta√ß√£o por Per√≠odo
            </option>
            <option value="estoqueMinimo">Alertas de Estoque M√≠nimo</option>
          </select>
        </div>

        <div id="filtroPeriodo" class="form-group" style="display: none">
          <label for="dataInicio">Data In√≠cio:</label>
          <input type="date" id="dataInicio" />

          <label for="dataFim">Data Fim:</label>
          <input type="date" id="dataFim" />
        </div>

        <button onclick="gerarRelatorio()">Gerar Relat√≥rio</button>

        <div id="resultadoRelatorio" class="card" style="margin-top: 20px; display: none">
          <h3>Resultado do Relat√≥rio</h3>
          <div class="table-responsive">
            <div id="conteudoRelatorio"></div>
            <button class="no-print" onclick="window.print()" style="margin-top: 10px">
              Imprimir Relat√≥rio
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Modal para visualiza√ß√£o/edi√ß√£o -->
  <div id="modalBobina" class="modal">
    <div class="modal-content tabela-grande">
      <span class="close" onclick="fecharModal()">&times;</span>
      <h2 id="modalTitulo"></h2>
      <div id="modalConteudo">
        <!-- Conte√∫do ser√° inserido via JavaScript -->
      </div>
      <div class="qr-code-container" id="qrCodeContainer">
        <!-- QR Code ser√° gerado aqui -->
      </div>
      <button class="no-print" onclick="imprimirEtiqueta()">
        Imprimir Etiqueta
      </button>
    </div>
  </div>

  <!-- Modal para sa√≠da de estoque -->
  <div id="modalSaida" class="modal">
    <div class="modal-content">
      <span class="close" onclick="fecharModal()">&times;</span>
      <h2>Registrar Sa√≠da de Estoque</h2>
      <form id="formSaida">
        <input type="hidden" id="idBobinaSaida" />

        <div class="form-group">
          <label for="tipoMaquina">Tipo de M√°quina:</label>
          <select id="tipoMaquina" required>
            <option value="">Selecione...</option>
            <option value="Rebobinadeira">Rebobinadeira</option>
            <option value="Desenroladeira">Desenroladeira</option>
            <option value="Impressora flexo">Impressora flexo</option>
            <option value="Impressora laminadora">
              Impressora laminadora
            </option>
            <option value="Impressora off set rotativa">
              Impressora off set rotativa
            </option>
            <!-- NOVA -->
          </select>
        </div>

        <div class="form-group">
          <label for="pesoSaida">Peso da Bobina (kg):</label>
          <input type="number" id="pesoSaida" step="0.01" min="0" required />
        </div>

        <div class="form-group">
          <label for="usuarioSaida">Usu√°rio:</label>
          <input type="text" id="usuarioSaida" required />
        </div>

        <div class="form-group">
          <label for="observacaoSaida">Observa√ß√µes:</label>
          <input type="text" id="observacaoSaida" />
        </div>

        <button type="submit">Registrar Sa√≠da</button>
      </form>
    </div>
  </div>

  <!-- Modal para retorno ao estoque -->
  <div id="modalRetorno" class="modal">
    <div class="modal-content">
      <span class="close" onclick="fecharModal()">&times;</span>
      <h2>Registrar Retorno ao Estoque</h2>
      <form id="formRetorno">
        <input type="hidden" id="idBobinaRetorno" />
        <input type="hidden" id="idMovimentoRetorno" />
        <input type="hidden" id="tipoMaquinaRetorno" />

        <div class="form-group">
          <label for="pesoRestante">Peso Restante da Bobina Original (kg):</label>
          <input type="number" id="pesoRestante" step="0.01" min="0" required />
        </div>
        <div class="form-group">
          <label for="pesoUtilizado">Peso Utilizado (kg):</label>
          <input type="number" id="pesoUtilizado" step="0.01" min="0" required />
        </div>
        <div class="form-group">
          <label for="pesoPerda">Perda (kg):</label>
          <input type="number" id="pesoPerda" step="0.01" min="0" />
        </div>

        <div class="form-group">
          <label for="novaLargura">Nova Largura (cm):</label>
          <input type="number" id="novaLargura" step="0.01" min="0" />
        </div>

        <div class="form-group">
          <label for="novaGramatura">Nova Gramatura (g/m¬≤):</label>
          <input type="number" id="novaGramatura" step="0.01" min="0" />
        </div>

        <div class="tipo-retorno-container" id="tipoRetornoContainer">
          <h4>Tipo de Retorno:</h4>
          <div class="tipo-retorno-option">
            <input type="radio" id="retornoBobinas" name="tipoRetorno" value="bobinas" checked />
            <label for="retornoBobinas">Bobinas</label>
          </div>
          <div class="tipo-retorno-option">
            <input type="radio" id="retornoFolhas" name="tipoRetorno" value="folhas" />
            <label for="retornoFolhas">Folhas</label>
          </div>
          <div class="tipo-retorno-option">
            <input type="radio" id="retornoAmbos" name="tipoRetorno" value="ambos" />
            <label for="retornoAmbos">Bobinas e Folhas</label>
          </div>
        </div>

        <!-- Campos para Bobinas -->
        <div id="bobinasContainer">
          <div class="form-group">
            <label for="quantidadeBobinas">Quantidade de Bobinas Geradas:</label>
            <input type="number" id="quantidadeBobinas" step="0.01" min="0." value="0" />
          </div>

          <div id="bobinasGeradasContainer" style="display: none">
            <h4>Bobinas Geradas</h4>
            <div id="bobinasGeradas"></div>
          </div>
        </div>

        <!-- Campos para Folhas -->
        <div id="folhasContainer" style="display: none">
          <div class="form-group">
            <label for="quantidadeFolhas">Quantidade de Folhas Geradas:</label>
            <input type="number" id="quantidadeFolhas" min="00.00" value="0" />
          </div>

          <div class="form-group">
            <label for="formatoFolhas">Formato das Folhas:</label>
            <input type="text" id="formatoFolhas" />
          </div>

          <div class="form-group">
            <label for="clienteFolhas">Cliente:</label>
            <input type="text" id="clienteFolhas" />
          </div>
        </div>

        <div class="form-group">
          <label for="observacaoRetorno">Observa√ß√µes:</label>
          <input type="text" id="observacaoRetorno" />
        </div>

        <button type="submit">Registrar Retorno</button>
      </form>
    </div>
  </div>
  <div id="etiqueta" style="display: none">
    <h2>Etiqueta de Bobina</h2>
    <p><strong>C√≥digo:</strong> <span id="etiquetaCodigo"></span></p>
    <p>
      <strong>Tipo de Papel:</strong> <span id="etiquetaTipoPapel"></span>
    </p>
    <p><strong>Fabricante:</strong> <span id="etiquetaFabricante"></span></p>
    <p><strong>Peso:</strong> <span id="etiquetaPeso"></span> kg</p>
    <p><strong>Largura:</strong> <span id="etiquetaLargura"></span> cm</p>
    <p>
      <strong>Gramatura:</strong> <span id="etiquetaGramatura"></span> g/m¬≤
    </p>
    <p><strong>M√°quina:</strong> <span id="etiquetaMaquina"></span></p>
    <p><strong>Usu√°rio:</strong> <span id="etiquetaUsuario"></span></p>
    <p><strong>Data:</strong> <span id="etiquetaData"></span></p>
  </div>
  <hr>




  <script src="script.js" defer></script>
</body>

</html>